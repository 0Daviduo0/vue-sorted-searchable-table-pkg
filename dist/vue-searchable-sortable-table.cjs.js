"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),h=require("@heroicons/vue/20/solid"),z={class:"px-4 sm:px-6 lg:px-8"},M={class:"sm:flex sm:items-center"},H={class:"sm:flex-auto"},L={key:0,class:"text-base font-semibold text-gray-900"},I={key:1,class:"mt-2 text-sm text-gray-700"},T={class:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},K={key:0,class:"mt-6 mb-4"},q=["for"],F={class:"mt-2"},R={class:"flex rounded-md bg-white shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},U={class:"relative grid shrink-0 grid-cols-1"},j=["id"],P={key:0,value:"search"},G=["value"],O=["id","placeholder"],Q={class:"mt-8 flow-root"},X={class:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},Y={class:"min-w-full divide-y divide-gray-300"},J=["onClick"],W={class:"divide-y divide-gray-200 bg-white"},Z={key:0},_=["colspan"],ee={key:1},te=["colspan"],le={key:0,class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm sm:pr-0"},N={__name:"Table",props:{title:String,description:String,items:{type:Array,required:!0},columns:{type:Array,required:!0},itemKeyField:{type:String,required:!0},showAddButton:{type:Boolean,default:!0},addLabel:{type:String,default:"Aggiungi elemento"},isLoading:{type:Boolean,default:!1},emptyStateMessage:{type:String,default:"Nessun elemento trovato."},initialSortKey:{type:String,default:null},initialSortDirection:{type:String,default:"asc"},externalSort:{type:Boolean,default:!1},showDefaultActionsHeader:{type:Boolean,default:!1},tableMaxHeight:{type:String,default:null},searchable:{type:Boolean,default:!0},searchAll:{type:Boolean,default:!1},searchDebounceTime:{type:Number,default:1e3}},emits:["add-item","sort-change","search"],setup(n,{emit:m}){const t=n,p=m,f=e.getCurrentInstance(),g=f?String(f.uid):Math.random().toString(36).substring(2,9),c=e.ref(t.initialSortKey),u=e.ref(t.initialSortDirection);e.watch(()=>[t.initialSortKey,t.initialSortDirection],([l,o])=>{t.externalSort||(c.value=l,u.value=o)});const k=e.computed(()=>t.externalSort?t.initialSortKey:c.value),V=e.computed(()=>t.externalSort?t.initialSortDirection:u.value);function C(l){if(t.externalSort){let o="asc";t.initialSortKey===l&&(o=t.initialSortDirection==="asc"?"desc":"asc"),p("sort-change",{key:l,direction:o})}else c.value===l?u.value=u.value==="asc"?"desc":"asc":(c.value=l,u.value="asc")}const v=e.computed(()=>t.externalSort||!c.value?t.items:[...t.items].sort((l,o)=>{const a=l[c.value],r=o[c.value];let i=0;const S=a===null||typeof a>"u",B=r===null||typeof r>"u";if(S&&B)i=0;else if(S)i=-1;else if(B)i=1;else if(typeof a=="string"&&typeof r=="string")i=a.localeCompare(r);else if(typeof a=="number"&&typeof r=="number")i=a-r;else{const w=String(a).toLowerCase(),E=String(r).toLowerCase();w<E&&(i=-1),w>E&&(i=1)}return u.value==="asc"?i:-i})),s=e.ref(null),y=e.ref("");let b=null;const d=e.computed(()=>t.columns.filter(l=>l.isSearchableField!==!1).map(l=>({key:l.key,label:l.label}))),D=e.computed(()=>{if(!s.value)return"Ricerca";if(s.value==="search")return"Ricerca Globale";const l=d.value.find(o=>o.key===s.value);return`Ricerca in "${(l==null?void 0:l.label)||s.value}"`}),A=e.computed(()=>{if(s.value==="search")return"Cerca ovunque...";const l=d.value.find(o=>o.key===s.value);return`Cerca in ${(l==null?void 0:l.label)||"seleziona campo"}...`});function x(){t.searchable&&(t.searchAll?s.value="search":d.value.length>0?s.value=d.value[0].key:s.value=null)}e.onMounted(()=>{x()}),e.watch(()=>[t.columns,t.searchAll],()=>{const l=s.value==="search"&&t.searchAll||d.value.some(o=>o.key===s.value);t.searchable&&!l?x():t.searchable||(s.value=null)},{deep:!0,immediate:!0});function $(){clearTimeout(b),b=setTimeout(()=>{const l=y.value.trim(),o=s.value;l===""?p("search",""):o&&p("search",`${o}=${l}`)},t.searchDebounceTime)}return e.watch([y,s],()=>{t.searchable&&$()}),(l,o)=>(e.openBlock(),e.createElementBlock("div",z,[e.createElementVNode("div",M,[e.createElementVNode("div",H,[n.title?(e.openBlock(),e.createElementBlock("h1",L,e.toDisplayString(n.title),1)):e.createCommentVNode("",!0),n.description?(e.openBlock(),e.createElementBlock("p",I,e.toDisplayString(n.description),1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",T,[e.renderSlot(l.$slots,"header-actions",{},()=>[n.showAddButton?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:o[0]||(o[0]=a=>l.$emit("add-item")),type:"button",class:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},e.toDisplayString(n.addLabel),1)):e.createCommentVNode("",!0)])])]),t.searchable&&(d.value.length>0||t.searchAll)?(e.openBlock(),e.createElementBlock("div",K,[e.createElementVNode("label",{for:`table-search-input-${e.unref(g)}`,class:"block text-sm font-medium leading-6 text-gray-900"},e.toDisplayString(D.value),9,q),e.createElementVNode("div",F,[e.createElementVNode("div",R,[e.createElementVNode("div",U,[e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":o[1]||(o[1]=a=>s.value=a),id:`search-field-select-${e.unref(g)}`,name:"search-field-select","aria-label":"Campo di ricerca",class:"col-start-1 row-start-1 block w-full appearance-none rounded-l-md border-0 bg-transparent py-1.5 pl-3 pr-7 text-gray-500 focus:ring-0 sm:text-sm sm:leading-6"},[t.searchAll?(e.openBlock(),e.createElementBlock("option",P," Cerca ovunque ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,a=>(e.openBlock(),e.createElementBlock("option",{key:a.key,value:a.key},e.toDisplayString(a.label),9,G))),128))],8,j),[[e.vModelSelect,s.value]]),e.createVNode(e.unref(h.ChevronDownIcon),{class:"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-400","aria-hidden":"true"})]),e.withDirectives(e.createElementVNode("input",{type:"text",name:"table-search-input",id:`table-search-input-${e.unref(g)}`,"onUpdate:modelValue":o[2]||(o[2]=a=>y.value=a),class:"block min-w-0 flex-1 rounded-r-md border-0 bg-transparent py-1.5 pl-3 pr-3 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:A.value},null,8,O),[[e.vModelText,y.value]])])])])):e.createCommentVNode("",!0),e.createElementVNode("div",Q,[e.createElementVNode("div",{class:e.normalizeClass(["-mx-4 -my-2 sm:-mx-6 lg:-mx-8",t.tableMaxHeight?"":"overflow-x-auto"]),style:e.normalizeStyle(t.tableMaxHeight?{maxHeight:t.tableMaxHeight,overflowY:"auto",overflowX:"auto"}:{})},[e.createElementVNode("div",X,[e.createElementVNode("table",Y,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.columns,a=>(e.openBlock(),e.createElementBlock("th",{key:a.key,scope:"col",class:e.normalizeClass(["py-3.5 text-left text-sm font-semibold text-gray-900",a.headerClass||"",a.key===(n.columns[0]&&n.columns[0].key)?"pl-4 pr-3 sm:pl-0":"px-3",t.tableMaxHeight?"sticky top-0 z-10 border-b border-gray-300 bg-white bg-opacity-95 backdrop-blur-sm":""]),onClick:r=>a.sortable?C(a.key):null,style:e.normalizeStyle(a.sortable?"cursor: pointer;":{})},[e.createElementVNode("a",{href:"#",class:"group inline-flex items-center",onClick:o[3]||(o[3]=e.withModifiers(()=>{},["prevent"]))},[e.createElementVNode("span",null,e.toDisplayString(a.label),1),a.sortable?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["ml-2 flex-none rounded",k.value===a.key?t.tableMaxHeight?"bg-gray-200 text-gray-900":"bg-gray-100 text-gray-900 group-hover:bg-gray-200":"text-gray-400 invisible group-hover:visible group-focus:visible"])},[k.value===a.key?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[V.value==="asc"?(e.openBlock(),e.createBlock(e.unref(h.ChevronUpIcon),{key:0,class:"size-5","aria-hidden":"true"})):(e.openBlock(),e.createBlock(e.unref(h.ChevronDownIcon),{key:1,class:"size-5","aria-hidden":"true"}))],64)):(e.openBlock(),e.createBlock(e.unref(h.ChevronDownIcon),{key:1,class:"size-5","aria-hidden":"true"}))],2)):e.createCommentVNode("",!0)])],14,J))),128)),l.$slots["row-actions-header"]||n.showDefaultActionsHeader?(e.openBlock(),e.createElementBlock("th",{key:0,scope:"col",class:e.normalizeClass(["relative py-3.5 pl-3 pr-0",t.tableMaxHeight?"sticky top-0 z-10 border-b border-gray-300 bg-white bg-opacity-95 backdrop-blur-sm":""])},[e.renderSlot(l.$slots,"row-actions-header",{},()=>[o[4]||(o[4]=e.createElementVNode("span",{class:"sr-only"},"Azioni",-1))])],2)):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",W,[n.isLoading?(e.openBlock(),e.createElementBlock("tr",Z,[e.createElementVNode("td",{colspan:n.columns.length+(l.$slots["row-actions-cell"]||n.showDefaultActionsHeader?1:0),class:"whitespace-nowrap px-3 py-4 text-sm text-center text-gray-500"}," Caricamento dati... ",8,_)])):!v.value.length&&!n.isLoading?(e.openBlock(),e.createElementBlock("tr",ee,[e.createElementVNode("td",{colspan:n.columns.length+(l.$slots["row-actions-cell"]||n.showDefaultActionsHeader?1:0),class:"whitespace-nowrap px-3 py-4 text-sm text-center text-gray-500"},e.toDisplayString(n.emptyStateMessage),9,te)])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value,a=>(e.openBlock(),e.createElementBlock("tr",{key:a[n.itemKeyField]},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.columns,r=>(e.openBlock(),e.createElementBlock("td",{key:r.key,class:e.normalizeClass(["whitespace-nowrap py-4 text-sm",r.cellClass||"",r.key===(n.columns[0]&&n.columns[0].key)?"pl-4 pr-3 font-medium text-gray-900 sm:pl-0":"px-3 text-gray-500"])},[e.renderSlot(l.$slots,`cell-${r.key}`,{item:a,value:a[r.key]},()=>[e.createTextVNode(e.toDisplayString(a[r.key]===null||typeof a[r.key]>"u"?"---":a[r.key]),1)])],2))),128)),l.$slots["row-actions-cell"]||n.showDefaultActionsHeader?(e.openBlock(),e.createElementBlock("td",le,[e.renderSlot(l.$slots,"row-actions-cell",{item:a})])):e.createCommentVNode("",!0)]))),128))])])])],6)])]))}},ae={install:(n,m)=>{const t=(m==null?void 0:m.componentName)||"Table";n.component(t,N)}};exports.Table=N;exports.default=ae;
